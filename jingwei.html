// 检查浏览器是否支持定位
if (!navigator.geolocation) {
  alert("您的浏览器不支持定位");
  return;
}

// 请求高精度位置
navigator.geolocation.getCurrentPosition(
  (position) => {
    const lat = position.coords.latitude;   // 纬度
    const lng = position.coords.longitude;  // 经度
    const accuracy = position.coords.accuracy; // 精度（米）

    console.log(`精确位置: ${lng}, ${lat}（精度: ${accuracy} 米）`);

    // 调用高德周边搜索（需坐标转换）
    searchNearbyRestaurants(lng, lat);
  },
  (error) => {
    switch (error.code) {
      case error.PERMISSION_DENIED:
        alert("用户拒绝了位置请求");
        break;
      case error.POSITION_UNAVAILABLE:
        alert("位置信息不可用");
        break;
      case error.TIMEOUT:
        alert("请求超时");
        break;
    }
  },
  {
    enableHighAccuracy: true, // 启用 GPS 高精度
    timeout: 10000,           // 10秒超时
    maximumAge: 30000         // 30秒内缓存可用
  }
);